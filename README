 *** eBPF Learning Lab (Docker on Mac) ***
This repository contains a complete development environment for writing and running eBPF programs using Golang.

Because eBPF requires a Linux Kernel, this project runs inside a Docker container with special privileges.


*** The Environment (Dockerfile Overview) ***
The Dockerfile creates a "trace-ready" Linux environment. Here is what it does:

Here is what it does:
* Base Image: Uses ubuntu:22.04 as the foundation.
* Dependencies: Installs clang, llvm, and libbpf-dev (required to compile C code into BPF bytecode). 
* Kernel Headers: Installs linux-headers-generic and creates a symbolic link so the compiler can find them (asm/types.h). 
* Go Installation: Automatically detects your architecture.
* BPF Tool: Manually installs bpftool v7.5.0 (essential for inspecting the kernel) to avoid version mismatches on Mac Docker. 

*** Project Structure ***
This lab is designed to hold multiple eBPF programs. Each program gets its own folder:
  /tracepoint - A program that hooks into kernel system calls.
  /xdp        - A program that acts as a low-level network firewall.

*** How to Build the Lab ***
Open your terminal in this folder and run:
    docker build -t ebpf-lab .

Start the Container:
    make start


*** How to Run the Code *** 
Once you are inside the container (root@...:/code#), follow these steps:

Step A: Initialize (First Time Only)
If you haven't initialized the Go module yet:

    make init


Step B: Build & Run
To compile the C code, generate the Go bindings, build the Go binary, and start the application:

To run the Tracepoint lab:
    export GOTOOLCHAIN=local
    make run APP=tracepoint

To run the XDP lab:
    export GOTOOLCHAIN=local
    make run APP=xdp


*** How to View the Logs ***
If an app uses `bpf_printk`, you need a second terminal to see the kernel logs.

    docker exec -it db6c135192a1 bash

    cat /sys/kernel/debug/tracing/trace_pipe